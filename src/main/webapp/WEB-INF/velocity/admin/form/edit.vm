#parse("/admin/header.vm")


<h3>Edit Form</h3>

<form class="form-horizontal" method="POST">

    <div class="control-group">
        <label class="control-label">Name</label>

        <div class="controls">
            #springFormInput("form.name")
        </div>
    </div>

    <div class="control-group">
        <label class="control-label">Use Captcha</label>

        <div class="controls">
            #springFormCheckbox("form.captcha")
        </div>
    </div>

    <div class="form-actions">
        <button type="submit" class="btn btn-primary">Save changes</button>
        <button type="button" class="btn">Cancel</button>
    </div>

</form>


<table class="table table-condensed table-hover" id="fields-table">
    <tr>
        <th>Id</th>
        <th>Name</th>
        <th>Type</th>
        <th>Required</th>
        <th></th>
    </tr>
    #foreach ($field in $fields)
        <tr data-field-id="$field.id" class="field-row">
            <td>$field.id</td>
            <td>$field.name</td>
            <td>$field.fieldType</td>
            <td>#if ($field.required) <span class="label label-important">Required</span>#end</td>
            <td>
                <a href="" role="button" class="btn btn-mini"> <i class="icon-pencil"></i></a>
                <a href="" role="button" class="btn btn-danger btn-mini"> <i class="icon-trash icon-white"></i></a></td>
        </tr>
    #end
</table>


<a href="/backoffice/form/$form.id/field/create" role="button" class="btn"> <i class="icon-plus"></i> Create Form Field</a>


<script>
    $(function () {
        $("#fields-table tbody").sortable({

            update: function (event, ui) {
                var order = []
                $("#fields-table tr.field-row").each(function (v) {
                    var id = $(this).attr("data-field-id")
                    order.push(id)
                })

                $.ajax({
                    type: "POST",
                    url: "/backoffice/form/$folder.id/field/order",
                    contentType: "text/plain",
                    data: order.join('-')
                });
            }
        });
        $("#fields-table tbody").disableSelection();
    });
</script>

#parse("/admin/footer.vm")